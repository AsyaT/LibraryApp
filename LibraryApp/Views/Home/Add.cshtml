@using LibraryApp.Models;
@model BookModel

@{ 
    Layout = null;
}
@{HtmlHelper.UnobtrusiveJavaScriptEnabled = true;}
<div id="addForm">
@using (Ajax.BeginForm("Add", "Home", new AjaxOptions { HttpMethod = "POST", UpdateTargetId = "addForm", InsertionMode = InsertionMode.ReplaceWith, OnComplete = "replaceTable()" }, new { enctype = "multipart/form-data" }))
{

    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Add new book</legend>
        <div class="form-group">
            @Html.LabelFor(model => model.Title)
            @Html.EditorFor(model => model.Title, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Title, "", new { @class = "text-danger" })
        </div>
        <div class="form-group" >
            @Html.LabelFor(model => model.Authors)

            <br />
            @for (int i = 0; i < Model.Authors.Count(); i++)
            {
                @Html.LabelFor(m => m.Authors[i].FirstName)
                @Html.EditorFor(m => m.Authors[i].FirstName, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(m => m.Authors[i].FirstName, "", new { @class = "text-danger" })

                @Html.LabelFor(m => m.Authors[i].LastName)
                @Html.EditorFor(m => m.Authors[i].LastName, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(m => m.Authors[i].LastName, "", new { @class = "text-danger" })
            }

            @{ 
                int orderNumber = 1;
                string uniqueControlId = "new";
            }

            <div id="authors-set-@uniqueControlId">
                @Ajax.ActionLink("Add extra author", "AddAuthor", new { quantity = orderNumber, controlId = uniqueControlId }, new AjaxOptions { HttpMethod = "GET", InsertionMode = InsertionMode.ReplaceWith, UpdateTargetId = "authors-set-"+ uniqueControlId })
            </div>
            
            @Html.ValidationMessageFor(model => model.Authors, "", new { @class = "text-danger" })

        </div>
            <div class="form-group">
                @Html.LabelFor(model => model.NumberOfPages)
                @Html.EditorFor(model => model.NumberOfPages, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.NumberOfPages, "", new { @class = "text-danger" })
            </div>
            <div class="form-group">
                @Html.LabelFor(model => model.Publisher)
                @Html.EditorFor(model => model.Publisher, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Publisher, "", new { @class = "text-danger" })
            </div>
            <div class="form-group">
                @Html.LabelFor(model => model.YearOfPublication)
                @Html.EditorFor(model => model.YearOfPublication, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.YearOfPublication, "", new { @class = "text-danger" })
            </div>
            <div class="form-group">
                @Html.LabelFor(model => model.Image)
                <input type="file" name="Image" class="input-files" />
            </div>
            <input type="submit" value="Save" class="btn btn-default"/>
</fieldset>
}
</div>